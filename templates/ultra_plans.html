{% extends "base.html" %}

{% block title %}Plans Premium - InvestCrypto Pro{% endblock %}

{% block content %}
<div class="space-y-6">
    <!-- Header avec animation -->
    <div class="text-center bg-gradient-to-r from-red-600 via-orange-500 to-yellow-500 text-white p-8 rounded-lg shadow-2xl">
        <h1 class="text-4xl font-extrabold mb-4">üíé PLANS PREMIUM üíé</h1>
        <p class="text-xl mb-4">Investissements √† rendement √©lev√© avec strat√©gies algorithmiques avanc√©es</p>
        <div class="text-lg font-bold">‚ö†Ô∏è OFFRE LIMIT√âE ! Places limit√©es ! ‚ö†Ô∏è</div>
    </div>

    <!-- Alerte de s√©curit√© -->
    <div class="bg-yellow-50 border-l-4 border-yellow-400 p-4 rounded-lg">
        <div class="flex">
            <div class="flex-shrink-0">
                <i class="fas fa-exclamation-triangle text-yellow-400"></i>
            </div>
            <div class="ml-3">
                <p class="text-sm text-yellow-700">
                    <strong>Information :</strong> Ces plans premium utilisent des strat√©gies de trading haute fr√©quence et d'IA pr√©dictive. 
                    Investissez uniquement ce que vous pouvez vous permettre de perdre.
                </p>
            </div>
        </div>
    </div>

    <!-- Filtres par dur√©e -->
    <div class="bg-white rounded-lg shadow-lg p-6">
        <h2 class="text-xl font-semibold mb-4">Filtrer par dur√©e</h2>
        <div class="flex flex-wrap gap-3">
            <button onclick="filterPlans('all')" class="px-4 py-2 bg-blue-500 text-white rounded-lg font-medium filter-btn active">
                Tous les plans
            </button>
            <button onclick="filterPlans('3')" class="px-4 py-2 bg-red-500 text-white rounded-lg font-medium filter-btn">
                3 jours (35%)
            </button>
            <button onclick="filterPlans('5')" class="px-4 py-2 bg-orange-500 text-white rounded-lg font-medium filter-btn">
                5 jours (30%)
            </button>
            <button onclick="filterPlans('7')" class="px-4 py-2 bg-yellow-500 text-white rounded-lg font-medium filter-btn">
                7 jours (25%)
            </button>
            <button onclick="filterPlans('10-14')" class="px-4 py-2 bg-purple-500 text-white rounded-lg font-medium filter-btn">
                10-14 jours (20-22%)
            </button>
        </div>
    </div>

    <!-- Plans Premium Grid -->
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6" id="ultra-plans-grid">
        {% for plan in ultra_plans %}
        <div class="ultra-plan-card bg-white rounded-lg shadow-xl overflow-hidden relative 
            {%- if plan.daily_rate >= 0.30 -%}
                border-4 border-red-500 bg-gradient-to-br from-red-50 to-orange-50 transform hover:scale-105
            {%- elif plan.daily_rate >= 0.25 -%}
                border-3 border-orange-500 bg-gradient-to-br from-orange-50 to-yellow-50 transform hover:scale-105
            {%- elif plan.daily_rate >= 0.20 -%}
                border-3 border-purple-500 bg-gradient-to-br from-purple-50 to-pink-50 transform hover:scale-105
            {%- endif -%}
            transition-all duration-300" data-duration="{{ plan.duration_days }}">

            <!-- Badge ultra-rentable -->
            <div class="absolute top-0 left-0 right-0 z-10">
                {% if plan.daily_rate >= 0.35 %}
                <div class="bg-red-600 text-white text-center py-2 font-bold animate-pulse">
                    üöÄ METEORE - 35%/JOUR üöÄ
                </div>
                {% elif plan.daily_rate >= 0.30 %}
                <div class="bg-red-600 text-white text-center py-2 font-bold animate-pulse">
                    üí• MEGA BOOSTER - 30%/JOUR üí•
                </div>
                {% elif plan.daily_rate >= 0.25 %}
                <div class="bg-orange-600 text-white text-center py-2 font-bold animate-pulse">
                    ‚ö° SUPER EXPRESS - 25%/JOUR ‚ö°
                </div>
                {% elif plan.daily_rate >= 0.22 %}
                <div class="bg-purple-600 text-white text-center py-2 font-bold">
                    ‚ö° LIGHTNING PRO - 22%/JOUR ‚ö°
                </div>
                {% elif plan.daily_rate >= 0.20 %}
                <div class="bg-purple-600 text-white text-center py-2 font-bold">
                    üî• TURBO FLASH - 20%/JOUR üî•
                </div>
                {% endif %}
            </div>

            <div class="p-6 pt-16">
                <div class="text-center">
                    <h3 class="text-2xl font-bold mb-3 text-gray-900">{{ plan.name }}</h3>

                    <!-- Taux de rendement spectaculaire -->
                    <div class="mb-4">
                        <div class="text-6xl font-extrabold mb-2
                            {%- if plan.daily_rate >= 0.30 -%} text-red-600 animate-pulse
                            {%- elif plan.daily_rate >= 0.25 -%} text-orange-600
                            {%- else -%} text-purple-600
                            {%- endif -%}">
                            {{ "%.0f"|format(plan.daily_rate * 100) }}%
                        </div>
                        <div class="text-lg font-bold text-gray-700">
                            PROFIT QUOTIDIEN GARANTI
                        </div>
                    </div>

                    <!-- D√©tails du plan -->
                    <div class="bg-white bg-opacity-70 p-4 rounded-lg mb-4">
                        <div class="grid grid-cols-2 gap-4 text-sm">
                            <div>
                                <div class="text-gray-500">Dur√©e</div>
                                <div class="font-bold text-lg">{{ plan.duration_days }} jours</div>
                            </div>
                            <div>
                                <div class="text-gray-500">Profit total</div>
                                <div class="font-bold text-lg text-green-600">
                                    {{ "%.0f"|format(plan.daily_rate * plan.duration_days * 100) }}%
                                </div>
                            </div>
                            <div>
                                <div class="text-gray-500">Minimum</div>
                                <div class="font-semibold">{{ "%.0f"|format(plan.min_amount) }} USDT</div>
                            </div>
                            <div>
                                <div class="text-gray-500">Maximum</div>
                                <div class="font-semibold">{{ "{:,.0f}".format(plan.max_amount) }} USDT</div>
                            </div>
                        </div>
                    </div>

                    <!-- Exemple de calcul -->
                    <div class="bg-green-50 p-4 rounded-lg mb-4 border-2 border-green-200">
                        <div class="text-sm text-green-700 font-bold mb-2">üí∞ Exemple avec 1,000 USDT :</div>
                        <div class="text-2xl font-bold text-green-600">
                            +{{ "%.0f"|format(1000 * plan.daily_rate * plan.duration_days) }} USDT
                        </div>
                        <div class="text-xs text-green-600">
                            ({{ "%.0f"|format(plan.daily_rate * 1000) }} USDT/jour √ó {{ plan.duration_days }} jours)
                        </div>
                    </div>

                    <!-- Caract√©ristiques uniques -->
                    <div class="text-left mb-4">
                        <div class="text-sm font-bold text-gray-700 mb-2">üéØ Caract√©ristiques :</div>
                        <ul class="text-xs text-gray-600 space-y-1">
                            {% if plan.daily_rate >= 0.30 %}
                            <li>‚úÖ Algorithme quantique r√©volutionnaire</li>
                            <li>‚úÖ Trading haute fr√©quence 24/7</li>
                            <li>‚úÖ IA pr√©dictive ultra-avanc√©e</li>
                            {% elif plan.daily_rate >= 0.25 %}
                            <li>‚úÖ Strat√©gies d'arbitrage premium</li>
                            <li>‚úÖ Acc√®s pools DeFi exclusifs</li>
                            <li>‚úÖ Automation compl√®te</li>
                            {% else %}
                            <li>‚úÖ Trading algorithmique professionnel</li>
                            <li>‚úÖ Diversification multi-march√©s</li>
                            <li>‚úÖ Gestion de risque optimis√©e</li>
                            {% endif %}
                        </ul>
                    </div>

                    <!-- Bouton d'investissement -->
                    <button onclick="showUltraInvestModal({{ plan.id }}, '{{ plan.name }}', {{ plan.min_amount }}, {{ plan.max_amount }}, {{ plan.daily_rate }}, {{ plan.duration_days }})" 
                            class="w-full py-3 px-6 text-lg font-bold text-white rounded-lg shadow-lg transform hover:scale-105 transition-all duration-200
                            {%- if plan.daily_rate >= 0.30 -%} bg-gradient-to-r from-red-600 to-red-700 hover:from-red-700 hover:to-red-800
                            {%- elif plan.daily_rate >= 0.25 -%} bg-gradient-to-r from-orange-600 to-orange-700 hover:from-orange-700 hover:to-orange-800
                            {%- else -%} bg-gradient-to-r from-purple-600 to-purple-700 hover:from-purple-700 hover:to-purple-800
                            {%- endif -%}">
                        INVESTIR MAINTENANT
                    </button>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>

    <!-- Section t√©moignages ultra-rentables -->
    <div class="bg-gradient-to-r from-green-600 to-blue-600 text-white p-8 rounded-lg shadow-2xl">
        <h2 class="text-3xl font-bold text-center mb-6">üèÜ T√©moignages R√©cents - Plans Premium</h2>
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
            <div class="bg-white bg-opacity-20 p-6 rounded-lg backdrop-blur-sm">
                <div class="text-center">
                    <div class="text-3xl font-bold mb-2">‚Ç¨12,500</div>
                    <div class="text-lg mb-2">gagn√© en 3 jours</div>
                    <div class="text-sm opacity-90">Plan Rocket Launch - Marc L.</div>
                    <div class="text-xs mt-2 opacity-75">"Incroyable ! 35% par jour, c'est du jamais vu !"</div>
                </div>
            </div>
            <div class="bg-white bg-opacity-20 p-6 rounded-lg backdrop-blur-sm">
                <div class="text-center">
                    <div class="text-3xl font-bold mb-2">‚Ç¨18,750</div>
                    <div class="text-lg mb-2">gagn√© en 5 jours</div>
                    <div class="text-sm opacity-90">Plan Mega Booster - Sarah K.</div>
                    <div class="text-xs mt-2 opacity-75">"30% quotidien, j'ai tripl√© mon capital !"</div>
                </div>
            </div>
            <div class="bg-white bg-opacity-20 p-6 rounded-lg backdrop-blur-sm">
                <div class="text-center">
                    <div class="text-3xl font-bold mb-2">‚Ç¨26,250</div>
                    <div class="text-lg mb-2">gagn√© en 7 jours</div>
                    <div class="text-sm opacity-90">Plan Super Express - David M.</div>
                    <div class="text-xs mt-2 opacity-75">"25% par jour pendant une semaine, fantastique !"</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Calculateur ultra-rentable -->
    <div class="bg-white rounded-lg shadow-lg p-6">
        <h2 class="text-2xl font-semibold mb-4 text-center">üßÆ Calculateur Premium</h2>
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">Montant d'investissement</label>
                <input type="number" id="ultraCalcAmount" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="Montant en USDT" min="50" step="50">
            </div>
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">Plan Premium</label>
                <select id="ultraCalcPlan" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                    <option value="">S√©lectionner un plan</option>
                    {% for plan in ultra_plans %}
                    <option value="{{ plan.daily_rate }},{{ plan.duration_days }},{{ plan.name }}">
                        {{ plan.name }} ({{ "%.0f"|format(plan.daily_rate * 100) }}%/jour)
                    </option>
                    {% endfor %}
                </select>
            </div>
            <div class="flex items-end">
                <button onclick="calculateUltraProfits()" class="w-full bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white py-2 px-4 rounded-md font-bold">
                    CALCULER
                </button>
            </div>
        </div>

        <div id="ultraResults" class="mt-6 grid grid-cols-1 md:grid-cols-4 gap-4 hidden">
            <div class="bg-blue-50 p-4 rounded-lg text-center">
                <div class="text-sm text-blue-600 mb-1">Profit quotidien</div>
                <div class="text-xl font-bold text-blue-700" id="ultraDailyProfit">0 USDT</div>
            </div>
            <div class="bg-green-50 p-4 rounded-lg text-center">
                <div class="text-sm text-green-600 mb-1">Profit total</div>
                <div class="text-xl font-bold text-green-700" id="ultraTotalProfit">0 USDT</div>
            </div>
            <div class="bg-purple-50 p-4 rounded-lg text-center">
                <div class="text-sm text-purple-600 mb-1">Montant final</div>
                <div class="text-xl font-bold text-purple-700" id="ultraFinalAmount">0 USDT</div>
            </div>
            <div class="bg-yellow-50 p-4 rounded-lg text-center">
                <div class="text-sm text-yellow-600 mb-1">ROI Total</div>
                <div class="text-xl font-bold text-yellow-700" id="ultraTotalROI">0%</div>
            </div>
        </div>
    </div>
</div>

<!-- Modal d'investissement ultra-rentable -->
<div id="ultraInvestModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50">
    <div class="flex items-center justify-center min-h-screen p-4">
        <div class="bg-white rounded-lg p-6 w-full max-w-lg">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-xl font-bold" id="ultraModalTitle">Plan Premium</h3>
                <button onclick="hideUltraInvestModal()" class="text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>

            <div class="space-y-4">
                <div class="bg-gradient-to-r from-red-50 to-orange-50 p-4 rounded-lg border-2 border-red-200">
                    <div class="text-sm font-bold text-red-700 mb-2">D√©tails du plan premium</div>
                    <div class="space-y-2 text-sm">
                        <div class="flex justify-between">
                            <span>Rendement quotidien:</span>
                            <span id="ultraModalDailyRate" class="font-bold text-red-600"></span>
                        </div>
                        <div class="flex justify-between">
                            <span>Dur√©e:</span>
                            <span id="ultraModalDuration" class="font-bold"></span>
                        </div>
                        <div class="flex justify-between">
                            <span>ROI total:</span>
                            <span id="ultraModalTotalROI" class="font-bold text-green-600"></span>
                        </div>
                        <div class="flex justify-between">
                            <span>Montant min - max:</span>
                            <span><span id="ultraModalMinAmount" class="font-semibold"></span> - <span id="ultraModalMaxAmount" class="font-semibold"></span> USDT</span>
                        </div>
                    </div>
                </div>

                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Montant √† investir</label>
                    <input type="number" id="ultraInvestAmount" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-500" placeholder="Montant en USDT">
                </div>

                <div class="bg-green-50 p-4 rounded-lg border-2 border-green-200">
                    <div class="text-sm text-green-700 mb-1">Estimation de gains</div>
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <div class="text-xs text-green-600">Profit quotidien</div>
                            <div class="text-lg font-bold text-green-700" id="ultraModalDailyProfit">0 USDT</div>
                        </div>
                        <div>
                            <div class="text-xs text-green-600">Profit total</div>
                            <div class="text-lg font-bold text-green-700" id="ultraModalTotalProfit">0 USDT</div>
                        </div>
                    </div>
                </div>

                

                <button onclick="submitUltraInvestment()" class="w-full bg-gradient-to-r from-red-600 to-orange-600 hover:from-red-700 hover:to-orange-700 text-white py-3 px-4 rounded-md font-bold text-lg">
                    CONFIRMER L'INVESTISSEMENT PREMIUM
                </button>
            </div>
        </div>
    </div>
</div>

<script>
let currentUltraPlan = null;

// Filtrage des plans
function filterPlans(duration) {
    const cards = document.querySelectorAll('.ultra-plan-card');
    const buttons = document.querySelectorAll('.filter-btn');

    // Mettre √† jour les boutons actifs
    buttons.forEach(btn => btn.classList.remove('active'));
    event.target.classList.add('active');

    cards.forEach(card => {
        const planDuration = parseInt(card.dataset.duration);
        let show = false;

        if (duration === 'all') {
            show = true;
        } else if (duration === '3') {
            show = planDuration === 3;
        } else if (duration === '5') {
            show = planDuration === 5;
        } else if (duration === '7') {
            show = planDuration === 7;
        } else if (duration === '10-14') {
            show = planDuration >= 10 && planDuration <= 14;
        }

        if (show) {
            card.style.display = 'block';
            card.classList.add('animate-fadeIn');
        } else {
            card.style.display = 'none';
        }
    });
}

// Calculateur ultra-rentable
function calculateUltraProfits() {
    const amount = parseFloat(document.getElementById('ultraCalcAmount').value) || 0;
    const planData = document.getElementById('ultraCalcPlan').value;
    const resultsDiv = document.getElementById('ultraResults');

    if (!amount || !planData) {
        resultsDiv.classList.add('hidden');
        return;
    }

    const [dailyRate, duration, planName] = planData.split(',');
    const dailyRateFloat = parseFloat(dailyRate);
    const durationInt = parseInt(duration);

    const dailyProfit = amount * dailyRateFloat;
    const totalProfit = dailyProfit * durationInt;
    const finalAmount = amount + totalProfit;
    const totalROI = (totalProfit / amount) * 100;

    document.getElementById('ultraDailyProfit').textContent = `${dailyProfit.toFixed(2)} USDT`;
    document.getElementById('ultraTotalProfit').textContent = `${totalProfit.toFixed(2)} USDT`;
    document.getElementById('ultraFinalAmount').textContent = `${finalAmount.toFixed(2)} USDT`;
    document.getElementById('ultraTotalROI').textContent = `${totalROI.toFixed(0)}%`;

    resultsDiv.classList.remove('hidden');
}

// Modal d'investissement ultra-rentable
function showUltraInvestModal(planId, planName, minAmount, maxAmount, dailyRate, duration) {
    currentUltraPlan = {
        id: planId,
        name: planName,
        minAmount: minAmount,
        maxAmount: maxAmount,
        dailyRate: dailyRate,
        duration: duration
    };

    document.getElementById('ultraModalTitle').textContent = planName;
    document.getElementById('ultraModalDailyRate').textContent = `${(dailyRate * 100).toFixed(0)}%`;
    document.getElementById('ultraModalDuration').textContent = `${duration} jours`;
    document.getElementById('ultraModalTotalROI').textContent = `${(dailyRate * duration * 100).toFixed(0)}%`;
    document.getElementById('ultraModalMinAmount').textContent = minAmount;
    document.getElementById('ultraModalMaxAmount').textContent = maxAmount.toLocaleString();

    document.getElementById('ultraInvestModal').classList.remove('hidden');
}

function hideUltraInvestModal() {
    document.getElementById('ultraInvestModal').classList.add('hidden');
    document.getElementById('ultraInvestAmount').value = '';
    document.getElementById('ultraModalDailyProfit').textContent = '0 USDT';
    document.getElementById('ultraModalTotalProfit').textContent = '0 USDT';
}

// Calculer les profits dans le modal
document.getElementById('ultraInvestAmount').addEventListener('input', function() {
    const amount = parseFloat(this.value) || 0;
    if (currentUltraPlan && amount > 0) {
        const dailyProfit = amount * currentUltraPlan.dailyRate;
        const totalProfit = dailyProfit * currentUltraPlan.duration;
        document.getElementById('ultraModalDailyProfit').textContent = `${dailyProfit.toFixed(2)} USDT`;
        document.getElementById('ultraModalTotalProfit').textContent = `${totalProfit.toFixed(2)} USDT`;
    } else {
        document.getElementById('ultraModalDailyProfit').textContent = '0 USDT';
        document.getElementById('ultraModalTotalProfit').textContent = '0 USDT';
    }
});

// Soumettre l'investissement ultra-rentable
async function submitUltraInvestment() {
    if (!currentUltraPlan) return;

    const amount = parseFloat(document.getElementById('ultraInvestAmount').value);

    if (!amount || amount < currentUltraPlan.minAmount || amount > currentUltraPlan.maxAmount) {
        showNotification(`Montant doit √™tre entre ${currentUltraPlan.minAmount} et ${currentUltraPlan.maxAmount} USDT`, 'error');
        return;
    }

    try {
        const response = await fetch('/invest-roi', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({
                plan_id: currentUltraPlan.id,
                amount: amount
            })
        });

        const data = await response.json();

        if (data.success) {
            showNotification(`Investissement ultra-rentable de ${amount} USDT r√©alis√© avec succ√®s dans ${currentUltraPlan.name}!`, 'success');
            hideUltraInvestModal();
            setTimeout(() => {
                window.location.href = '/dashboard';
            }, 2000);
        } else {
            showNotification(data.error || 'Erreur lors de l\'investissement', 'error');
        }
    } catch (error) {
        showNotification('Erreur de connexion', 'error');
    }
}

// Animation de fondu
const style = document.createElement('style');
style.textContent = `
    .animate-fadeIn {
        animation: fadeIn 0.5s ease-in-out;
    }
    @keyframes fadeIn {
        from { opacity: 0; transform: translateY(20px); }
        to { opacity: 1; transform: translateY(0); }
    }
`;
document.head.appendChild(style);
</script>
{% endblock %}